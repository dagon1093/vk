!function(e){function t(t){for(var r,i,s=t[0],l=t[1],d=t[2],u=0,h=[];u<s.length;u++)i=s[u],a[i]&&h.push(a[i][0]),a[i]=0;for(r in l)Object.prototype.hasOwnProperty.call(l,r)&&(e[r]=l[r]);for(n&&n(t);h.length;)h.shift()();return c.push.apply(c,d||[]),o()}function o(){for(var e,t=0;t<c.length;t++){for(var o=c[t],r=!0,s=1;s<o.length;s++){var l=o[s];0!==a[l]&&(r=!1)}r&&(c.splice(t--,1),e=i(i.s=o[0]))}return e}var r={},a={"web/photos":0},c=[];function i(t){if(r[t])return r[t].exports;var o=r[t]={i:t,l:!1,exports:{}};return e[t].call(o.exports,o,o.exports,i),o.l=!0,o.exports}i.m=e,i.c=r,i.d=function(e,t,o){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(i.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)i.d(o,r,function(t){return e[t]}.bind(null,r));return o},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/js/cmodules/";var s=window.webpackJsonp=window.webpackJsonp||[],l=s.push.bind(s);s.push=t,s=s.slice();for(var d=0;d<s.length;d++)t(s[d]);var n=l;c.push([193,"bundles/common"]),o()}({193:function(e,t,o){e.exports=o("YQuP")},"1OKH":function(e,t,o){"use strict";o.r(t),o.d(t,"photos",function(){return a});o("SRfc"),o("KKXr"),o("pIFo");var r=o("zxIV"),a={LOAD_TYPE_PHOTOS:"photos",LOAD_TYPE_ALBUMS:"albums",LOAD_TYPE_TAGGED:"tagged",MAX_DESC_INPUT_HEIGHT:600,changeAlbumPhoto(e){showBox("al_photos.php",{act:"change_thumb_box",album:e})},onMouseOverEditRow(e){var t=Object(r.geByClass1)("photos_photo_edit_row_desc_placeholder",e),o=Object(r.geByClass1)("photos_photo_edit_row_desc_input",e);Object(r.setTitle)(t,!1,Object(r.val)(o))},editInitSorter(){var e=Object(r.ge)("photos_container_photos");cur.photosEditSorter=new GridSorter(e,"photos_photo_edit_row_thumb",{onReorder:a.reorderPhotos})},updateEditHeaderPos(){void 0===cur.photosEditHeaderEl&&(cur.photosEditHeaderEl=Object(r.geByClass1)("photos_edit_selection_header")),cur.photosEditHeaderEl&&(cur.photosEditHeaderElOffset=cur.photosEditHeaderElOffset||Object(r.getXY)(cur.photosEditHeaderEl)[1]-Object(r.getSize)(Object(r.ge)("page_header_cont"))[1],scrollGetY()>=cur.photosEditHeaderElOffset?Object(r.hasClass)(cur.photosEditHeaderEl,"photos_header_fixed")||(Object(r.addClass)(cur.photosEditHeaderEl,"photos_header_fixed"),Object(r.setStyle)(cur.photosEditHeaderEl,{width:Object(r.getSize)(Object(r.ge)("page_body"))[0]}),Object(r.setStyle)(Object(r.domNS)(cur.photosEditHeaderEl),{"margin-top":Object(r.getSize)(cur.photosEditHeaderEl)[1]+"px"})):(Object(r.removeClass)(cur.photosEditHeaderEl,"photos_header_fixed"),Object(r.setStyle)(cur.photosEditHeaderEl,{width:""}),Object(r.setStyle)(Object(r.domNS)(cur.photosEditHeaderEl),{"margin-top":0})))},_editGetSelectedCount(){var e=Object(r.geByClass)("photos_edit_selected").length;if(cur.photoEditSelectedAll){var t=Object(r.geByClass)("photos_photo_edit_row").length;e=e<t?cur.count-t+e:cur.count}return e},editSelectAll(e){cur.photoEditSelectedAll=!e,each(Object(r.geByClass)("photos_photo_edit_row"),function(){Object(r.toggleClass)(this,"photos_edit_selected",cur.photoEditSelectedAll)}),a._editUpdateSelectedCounter()},_editUpdateSelectedCounter(){var e,t=a._editGetSelectedCount();e=t?getLang("photos_edit_selected_count").replace("{total}",cur.count).replace("{count}",t):langNumeric(cur.count,cur.lang.photos_edit_selected_count_initial,!0),Object(r.val)(Object(r.ge)("photos_edit_selected_label"),e);var o=Object(r.ge)("photos_edit_selected_actions");Object(r.toggleClass)(o,"photos_selected",!!t),Object(r.geByClass)("photos_edit_selected_action",o).forEach(function(e){Object(r.toggleClass)(e,"link_lock",!t)});var c=Object(r.ge)("photos_select_all_toggle");cur.photosEditSelectedHalf=t>=cur.count/2,cur.photosEditSelectedHalf?Object(r.val)(c,getLang("photos_edit_deselect_all")):Object(r.val)(c,getLang("photos_edit_select_all"))},selectEditPhoto(e,t){var o=Object(r.gpeByClass)("photos_photo_edit_row",t),c=Object(r.toggleClass)(o,"photos_edit_selected");if(e.shiftKey&&cur.photoEditPrevSelectedRowEl&&cur.photoEditPrevSelectedRowEl!=o)for(var i=Object(r.gpeByClass)("photos_edit_photos_container",t),s=Object(r.domFC)(i),l=0;l<2&&s;)s!=cur.photoEditPrevSelectedRowEl&&s!=o||l++,l&&Object(r.toggleClass)(s,"photos_edit_selected",c),s=Object(r.domNS)(s);return cur.photoEditPrevSelectedRowEl=o,a._editUpdateSelectedCounter(),cancelEvent(e),!1},startEditPhotoDescription(e,t){a.stopEditPhotoDescription();var o=Object(r.gpeByClass)("photos_edit_photos_container",t),c=Object(r.hasClass)(t,"photos_photo_edit_row")?t:Object(r.gpeByClass)("photos_photo_edit_row",t),i=Object(r.geByClass1)("photos_photo_edit_row_desc_cont",c),s=Object(r.geByClass1)("photos_photo_edit_row_desc_placeholder",c),l=Object(r.geByClass1)("photos_photo_edit_row_desc_input",c);function d(e,t,o,c){var i=clean(Object(r.val)(o)).split("\n").join("<br>")+"&nbsp;",s=Object(r.ce)("div",{innerHTML:i,className:"photos_photo_edit_row_desc_input"},{width:Object(r.getSize)(t)[0],display:"block",visibility:"hidden"});e.appendChild(s);var l=Object(r.getSize)(s)[1]+(browser.msie?10:0);Object(r.setStyle)(o,{height:Math.min(a.MAX_DESC_INPUT_HEIGHT,Math.round(l))}),Object(r.re)(s)}Object(r.val)(l,l.getAttribute("data-orig-desc")),d(i,s,l),Object(r.show)(l),addEvent(document,"click",a.stopEditPhotoDescription),removeEvent(l,"input"),addEvent(l,"input",d.pbind(i,s,l)),l.select(),Object(r.addClass)(o,"photos_desc_editing"),Object(r.addClass)(c,"photos_row_desc_editing"),e&&cancelEvent(e)},onEditPhotoDescriptionKeyPress(e){switch(e.keyCode){case 27:a.stopEditPhotoDescription(null,!0);break;case 9:a.stopEditPhotoDescription(null,!1);var t=Object(r.gpeByClass)("photos_photo_edit_row",e.currentTarget);(t=Object(r.domNS)(t))&&a.startEditPhotoDescription(null,t),cancelEvent(e)}},stopEditPhotoDescription(e,t){var o;e&&Object(r.hasClass)(e.target,"photos_photo_edit_row_desc_input")||(removeEvent(document,"click",a.stopEditPhotoDescription),each(Object(r.geByClass)("photos_row_desc_editing"),function(){o=this,Object(r.removeClass)(o,"photos_row_desc_editing");var e=Object(r.geByClass1)("photos_photo_edit_row_desc_placeholder",o),a=Object(r.geByClass1)("photos_photo_edit_row_desc_input",o),c=o.getAttribute("data-id"),i=o.getAttribute("data-edit-hash"),s="";t?s=a.getAttribute("data-orig-desc"):((s=trim(Object(r.val)(a)))!=a.getAttribute("data-orig-desc")&&ajax.post("al_photos.php",{act:"save_desc",photo:c,hash:i,text:s,edit:1},{}),a.setAttribute("data-orig-desc",s),e.titleSet=!1);Object(r.val)(e,clean(s)||getLang("photos_add_description_placeholder")),Object(r.toggleClass)(e,"photos_edit_has_desc",!!s),Object(r.hide)(a)}),Object(r.removeClass)(Object(r.gpeByClass)("photos_edit_photos_container",o),"photos_desc_editing"))},updatePeriods(){cur.periods=Object(r.geByClass)("photos_period_delimiter",Object(r.ge)("photos_all_block"))},destroyPeriod(){cur.fixedPeriod&&(Object(r.re)(cur.fixedPeriod),cur.fixedPeriod=!1,cur.fixedPeriodEl=!1)},fixPeriod(){if(Object(r.ge)("photos_albums_block")&&(a.headerHeight=a.headerHeight||Object(r.getSize)(Object(r.ge)("page_header_cont"))[1],cur.periods&&cur.periods.length)){var e=vk.staticheader?Math.max(scrollGetY(),a.headerHeight):scrollGetY()+a.headerHeight,t=!1,o=!1,c=Object(r.getSize)(cur.periods[0])[1];for(var i in cur.periods)if(cur.periods.hasOwnProperty(i)){if(Object(r.getXY)(cur.periods[i])[1]>=e)break;t=cur.periods[i];var s=intval(i)+1;o=!!cur.periods[s]&&Object(r.getXY)(cur.periods[s])[1]-e}if(t&&!cur.fileApiUploadStarted){if(t==cur.fixedPeriodEl)setTimeout(function(){Object(r.setStyle)(cur.fixedPeriod,{left:Object(r.getXY)(t)[0]+"px"})});else{if(cur.fixedPeriod)cur.fixedPeriod.innerHTML=t.innerHTML;else{var l=cur.fixedPeriod=Object(r.ce)("div",{innerHTML:t.innerHTML,className:"photos_period_delimiter_fixed"},{left:Object(r.getXY)(t)[0]+"px"});Object(r.ge)("page_body").appendChild(cur.fixedPeriod),(cur._back?cur._back.hide:cur.destroy).push(function(){Object(r.re)(l)})}cur.fixedPeriodEl=t}var d=!1!==o?o-c:0;d>=0&&(d=0),cur.fixedPeriodTop!==d&&(Object(r.setStyle)(cur.fixedPeriod,{top:d+"px"}),cur.fixedPeriodTop=d)}else!t&&cur.fixedPeriod&&(Object(r.re)(cur.fixedPeriod),cur.fixedPeriod=!1,cur.fixedPeriodEl=!1)}},scrollResize(){if(!browser.mobile&&!cur.pvShown){var e=document.documentElement,t=window.innerHeight||e.clientHeight||bodyNode.clientHeight,o=scrollGetY(),c=Object(r.ge)("ui_photos_load_more"),i=Object(r.ge)("ui_albums_load_more"),s=Object(r.ge)("ui_tagged_load_more"),l=.8*t;Object(r.isVisible)(c)&&c.offsetTop-(o+t)<l&&a.load(),Object(r.isVisible)(i)&&cur.showAllAlbums&&i.offsetTop-(o+t)<l&&a.load(a.LOAD_TYPE_ALBUMS),Object(r.isVisible)(s)&&cur.showAllTagged&&s.offsetTop-(o+t)<l&&a.load(a.LOAD_TYPE_TAGGED),cur.fixPeriods&&a.fixPeriod(),a.updateEditHeaderPos()}},initScroll(){cur.module="photos",a.scrollnode=browser.msie6?pageNode:window,addEvent(a.scrollnode,"scroll",a.scrollResize),addEvent(window,"resize",a.scrollResize),removeEvent(window,"load",a.initScroll),cur.destroy.push(function(){removeEvent(a.scrollnode,"scroll",a.scrollResize),removeEvent(window,"resize",a.scrollResize)})},recache(e,t){if(cur.loading)return cur.loading=1,void setTimeout(a.recache.pbind(e,t),100);for(var o=cur.offset;ajaxCache["/"+nav.objLoc[0]+"#act="+nav.objLoc.act+"&offset="+o+"&part=1"];o+=20){var r=ajaxCache["/"+nav.objLoc[0]+"#act="+nav.objLoc.act+"&offset="+o+"&part=1"];r[0]+=t,ajaxCache["/"+nav.objLoc[0]+"#act="+nav.objLoc.act+"&offset="+(o+t)+"&part=1"]=r,delete ajaxCache["/"+nav.objLoc[0]+"#act="+nav.objLoc.act+"&offset="+o+"&part=1"]}cur.offset+=t},loaded(e,t,o,c){var i,s,l,d,n,u;switch(c||(cur.loading=0),c=c||a.LOAD_TYPE_PHOTOS){case a.LOAD_TYPE_TAGGED:cur.taggedOffset=e,l=cur.moreFromTagged,n=cur.moreTaggedOpts,d=cur.taggedOffset;break;case a.LOAD_TYPE_ALBUMS:cur.albumsOffset=e,l=cur.moreFromAlbums,n=cur.moreAlbumsOpts,d=cur.albumsOffset,u=cur.albumsCount;break;default:cur.offset=e,l=cur.moreFrom,n=cur.moreOpts,d=cur.offset,u=cur.count}i=Object(r.ge)("photos_container_"+c),s=Object(r.ge)("ui_"+c+"_load_more");for(var h=Object(r.ce)("div",{innerHTML:trim(t)});h.firstChild;){if(Object(r.hasClass)(h.firstChild,"photos_period_delimiter")){var p=h.firstChild.getAttribute("data-year");if(Object(r.geByClass1)("photos_period_delimiter_"+p)){Object(r.re)(h.firstChild);continue}}cur.photoEditSelectedAll&&Object(r.addClass)(h.firstChild,"photos_edit_selected"),i.appendChild(h.firstChild)}o&&extend(cur.privacy,o),c==a.LOAD_TYPE_PHOTOS&&a.updatePeriods(),e>=u||!t?Object(r.hide)(s):c!=a.LOAD_TYPE_PHOTOS&&(cur.loading=1,ajax.post(l,extend({offset:d,part:1},n||{}),{cache:1,onDone:function(){2==cur.loading?a.loaded.apply(window,arguments):cur.loading=!1},onFail:function(){return cur.loading=0,!0}}))},load(e){var t,o,c,i;switch(e=e||a.LOAD_TYPE_PHOTOS){case a.LOAD_TYPE_PHOTOS:t=Object(r.ge)("ui_photos_load_more"),o=cur.moreFrom,c=cur.moreOpts,i=cur.offset;break;case a.LOAD_TYPE_TAGGED:t=Object(r.ge)("ui_tagged_load_more"),o=cur.moreFromTagged,c=cur.moreTaggedOpts,i=cur.taggedOffset;break;case a.LOAD_TYPE_ALBUMS:t=Object(r.ge)("ui_albums_load_more"),o=cur.moreFromAlbums,c=cur.moreAlbumsOpts,i=cur.albumsOffset}o&&Object(r.isVisible)(t)&&!isButtonLocked(t)&&(cur.loading?cur.loading=2:(e==a.LOAD_TYPE_PHOTOS&&c&&(cur.loading=1),ajax.post(o,extend({offset:i,part:1},c||{}),{onDone:a.loaded,onFail:function(){return cur.loading=0,!0},showProgress:function(){lockButton(t)},hideProgress:function(){unlockButton(t)},cache:1})))},loadMoreButtonClick(e){switch(e){case a.LOAD_TYPE_ALBUMS:cur.showAllAlbums=!0;break;case a.LOAD_TYPE_TAGGED:cur.showAllTagged=!0}this.load(e)},reorderAlbums(e,t,o){var r=e.id.replace("album",""),a=(t&&t.id||"").replace("album",""),c=(o&&o.id||"").replace("album","");ajax.post("al_photos.php",{act:"reorder_albums",album:r,before:a,after:c,hash:cur.reorderHash})},reorderPhotos(e,t,o){var a="edit"==nav.objLoc.act?"photo_edit_row_":"photo_row_",c=e.id.replace(a,""),i=(t&&t.id||"").replace(a,""),s=(o&&o.id||"").replace(a,""),l=Object(r.domData)(Object(r.ge)("photos_container_photos"),"rev");l=l?"1"===l?1:"":nav.objLoc.rev,ajax.post("al_photos.php",{act:"reorder_photos",photo:c,before:i,after:s,rev:l,hash:cur.reorderHash})},privacy(e){if("photos_move"==e){var t=Privacy.getValue(e);return(t=(t=t.split("_"))[2])!=cur.album.split("_")[1]&&a.movePhoto(t),!0}var o=e.match(/^album(\d+)/);if(o){var c=Object(r.ge)("album"+vk.id+"_"+o[1]);if(c){if(c.helper){var i=Object(r.getSize)(c);if(i[0]!=c.w||i[1]!=c.h){Object(r.setStyle)(c.helper,{width:i[0],height:i[1]-Object(r.ge)("photos_container").sorter.dh}),extend(c,{x:c.x-c.w/2+i[0]/2,w:i[0],y:c.y-c.h/2+i[1]/2,h:i[1]});for(var s=c.nextSibling;s&&s.nextSibling;s=s.nextSibling.nextSibling)Object(r.setStyle)(s.nextSibling,{left:s.offsetLeft,top:s.offsetTop})}}clearTimeout(cur["privacy_timer_"+e]),cur["privacy_timer_"+e]=setTimeout(ajax.post.pbind("al_friends.php",{act:"save_privacy",key:e,val:Privacy.getValue(e),hash:cur.privacyHash}),500)}}},deleteAlbum(e,t){showFastBox({title:getLang("photos_deleting_album"),dark:1,bodyStyle:"padding: 20px;"},getLang("photos_sure_del_album"),getLang("global_delete"),function(o){ajax.post("al_photos.php",{act:"delete_album",album:e,hash:t},{showProgress:lockButton.pbind(o),hideProgress:unlockButton.pbind(o)})},getLang("global_cancel"))},showSaved(e,t){var o=Object(r.ge)(e),a=function(){setTimeout(animate.pbind(o,{backgroundColor:t,borderLeftColor:"#D8DFEA",borderRightColor:"#D8DFEA",borderTopColor:"#D8DFEA",borderBottomColor:"#D8DFEA"},1e3),1e3)};Object(r.isVisible)(o)?animate(o,{backgroundColor:"#E7F1F9",borderLeftColor:"#4C96D4",borderRightColor:"#4C96D4",borderTopColor:"#4C96D4",borderBottomColor:"#4C96D4"},200,a):(Object(r.show)(o),a())},saveAlbum(e){var t={act:"save_album",album:cur.album,hash:cur.albumhash,title:Object(r.ge)("album_title").value,desc:Object(r.ge)("album_description").value,enable_hintach:isChecked("hintach_enabled_for_album")};if(!t.title)return notaBene("album_title");var o=cur.album.replace(vk.id+"_","");cur.privacy["album"+o]?extend(t,{view:Privacy.getValue("album"+o),comm:Privacy.getValue("albumcomm"+o)}):Object(r.ge)("album_only_check")&&extend(t,{main:isChecked("album_main_check"),only:isChecked("album_only_check"),comm:isChecked("album_comments_check")}),ajax.post("al_photos.php",t,{onDone:function(){var e=Object(r.ge)("album_main_check");e&&isChecked(e)&&(Object(r.addClass)(e,"on"),Object(r.addClass)(e,"disabled"),Object(r.hide)("album_delete_action"));var t=Object(r.ge)("photos_changes_saved");Object(r.setStyle)(t,{opacity:1}),setTimeout(function(){Object(r.setStyle)(t,{opacity:0})},1500)},showProgress:lockButton.pbind(e),hideProgress:unlockButton.pbind(e)})},savePhotos(){for(var e={act:"save_photos",album:cur.album,hash:cur.albumhash},t=Object(r.ge)("photos_container"),o=0,c=t.firstChild;c;c=c.nextSibling)if(c.firstChild&&Object(r.isVisible)(c.firstChild)){var i=c.id.replace("photo_edit_row","");e["photo_id"+o]=i,e["photo_desc"+o]=Object(r.ge)("photo_caption"+i).value,++o}ajax.post("al_photos.php",e,{onDone:function(){for(var e=t.firstChild;e;e=e.nextSibling)if(e.firstChild&&Object(r.isVisible)(e.firstChild)){var o=e.id.replace("photo_edit_row","");Object(r.ge)("photo_save_result"+o).innerHTML=getLang("photos_privacy_description")}cur.descs=!1,scrollToTop(200),a.showSaved("photos_saved_msg","#F3F8FC"),Object(r.ge)("photos_container").sorter&&sorter.update(Object(r.ge)("photos_container").sorter.elems[0])},progress:"photos_save_progress"})},deleteSelectedPhotos(e){var t=[];each(Object(r.geByClass)("photos_edit_selected"),function(){t.push(this.getAttribute("data-id"))});var o=intval(a._editGetSelectedCount()>t.length),c=cur.album.split("_");showBox("/al_photos.php",{act:"delete_selected_box",Photo_ids:o?"":t.join(","),owner_id:c[0],album_id:c[1],all:o},{onDone(){var t=curBox();t.removeButtons(),t.addButton(getLang("photos_del_selected_box_yes"),t=>{Object(r.show)("photos_del_box_progress"),Object(r.hide)("photos_del_box_text"),Object(r.re)(t);var o=Object(r.ge)("photos_del_box_progress_text");a.doEditBatchProcess({act:"delete_photos",hash:e,owner_id:c[0],album_id:c[1]},cur.editDeletePhotosArray,Object(r.ge)("photos_del_box_progress_wrap"),"photos_del_selected_title_progress",function(e,t,c,i,s){Object(r.val)(o,getLang("photos_del_selected_box_text_progress").replace("{count}",i).replace("{total}",s)),cur.count=Math.max(cur.count-e,0),each(c,function(e,t){Object(r.re)("photo_edit_row_"+t),cur.count=Math.max(cur.count,0)}),a._editUpdateSelectedCounter()},function(){var e=curBox();(e&&e.hide(),0==cur.count)?nav.reload():Object(r.geByClass)("photos_photo_edit_row").length<40&&a.load()})}),t.addButton(getLang("box_cancel"),function(){t.hide(),cur.editDeletePhotosArray=!1},"no")}})},doEditBatchProcess(e,t,o,a,c,i){var s=t.split(","),l=s.length,d=cur.editPhotosMaxChunkSize||50,n=Math.ceil(l/d),u=Object(r.geByClass1)("photos_progress_bar",Object(r.ge)(o))||Object(r.geByClass1)("ui_progress_bar",Object(r.ge)(o)),h=0,p=document.title,_=curBox();c(0,!1,[],0,l),function t(o){if(!_.isVisible())return i(h),void Object(r.setDocumentTitle)(p);var b=s.slice(o*d,(o+1)*d);ajax.post("/al_photos.php",extend({photos:b.join(",")},e),{onDone:function(e,s,d){h+=e,o++,Object(r.setStyle)(u,{width:100*o/n+"%"});var _=getLang(a).replace("{count}",h).replace("{total}",l);Object(r.setDocumentTitle)(_),c(e,s,b,h,l,d),o<n?t(o):setTimeout(function(){Object(r.setDocumentTitle)(p),i(h,s)},200)}})}(0)},_showProgressPanel(e){var t=Object(r.se)('<div class="photo_mask_progress _photo_mask_progress"><div class="round_spinner"></div></div>');return e.appendChild(t),t},_hideProgressPanel(e){Object(r.re)(Object(r.geByClass1)("_photo_mask_progress",e))},deletePhoto(e,t,o,c){var i;if(""===e&&o&&(i=Object(r.gpeByClass)("photos_photo_edit_row",o),e=Object(r.attr)(i,"data-id"),t=Object(r.attr)(i,"data-edit-hash")),i=i||Object(r.ge)("photo_edit_row_"+e)){var s=a._showProgressPanel(i);return Object(r.addClass)(i,"photos_deleted"),ajax.post("al_photos.php",{act:"delete_photo",photo:e,hash:t,edit:1},{onDone:function(e){Object(r.re)(s),i.appendChild(Object(r.se)(e)),a.recache(cur.offset,-1),cur.count-=1,a._editUpdateSelectedCounter(),cur.count<2&&Object(r.hide)("album_thumb_action"),Object(r.ge)("photos_go_to_album_cont")&&!cur.count&&Object(r.hide)("photos_go_to_album_cont"),cur.photoAddUpdate&&cur.photoAddUpdate(i),cur.introTooltipHide&&cur.introTooltipHide(!0)}}),cancelEvent(c)}},restorePhoto(e,t,o){var c=Object(r.ge)("photo_edit_row_"+t);if(c&&Object(r.hasClass)(c,"photos_deleted")){var i=a._showProgressPanel(c);Object(r.re)(Object(r.geByClass1)("photos_restore",c)),ajax.post("al_photos.php",{act:"restore_photo",photo:t,hash:o,edit:1},{onDone:function(){Object(r.re)(i),Object(r.removeClass)(c,"photos_deleted"),a.recache(cur.offset,1),cur.count+=1,a._editUpdateSelectedCounter(),cur.count>1&&Object(r.show)("album_thumb_action"),Object(r.ge)("photos_go_to_album_cont")&&cur.count&&Object(r.show)("photos_go_to_album_cont"),cur.photoAddUpdate&&cur.photoAddUpdate(c)},progress:"photo_restore_progress"+t})}},toggleMoveToAlbumMode(e,t){var o=Object(r.ge)("photos_move_box_search"),c=Object(r.ge)("pv_move_to_album_cont"),i=Object(r.ge)("photos_box_edit_data"),s=curBox(),l=Object(r.geByClass1)("box_title",s.titleWrap);if(e){Object(r.hide)(o),Object(r.hide)(c),Object(r.show)(i),s.setOptions({width:500});var d=getLang("photos_move_to_new_album_title");cur.noAlbums||(d+=`\n          <span class="divider">|</span>\n          <a onclick="return photos.toggleMoveToAlbumMode(false, event)" href="" class="toggle">\n            ${getLang("photos_move_to_another_album_toggle")}\n          </a>\n        `),Object(r.val)(l,d),s.removeButtons().addButton(getLang("photos_create_album_and_move"),cur.saveNewAlbum).addButton(getLang("global_cancel"),s.hide,"no"),cur.onNewAlbumDone=function(e){curBox().hide(),a.movePhotosBox(cur.editPhotosArray.split(","),!1,function(){setTimeout(function(){var t=Object(r.ge)("album"+e);a.doMovePhotos(!1,t)})})}}else Object(r.show)(o),Object(r.show)(c),Object(r.hide)(i),s.setOptions({width:795}),Object(r.val)(l,getLang("photos_move_box_title")+'<span class="divider">|</span><a onclick="return photos.toggleMoveToAlbumMode(true, event)" href="" class="toggle">'+getLang("photos_move_to_new_album")+"</a>"),s.removeButtons().addButton(getLang("global_cancel"),s.hide);return cancelEvent(t)},showMove(e,t,o){var c=cur.moveddc,i=Object(r.ge)("photos_move_link"+e);cur.privacyPhotoMove?Privacy.show(i,o,"photos_move"):(cur.zIndexUpdated&&(a.hideMove(),cur.noZIndexUpdate=!0),Object(r.ge)("photo_edit_row"+e)&&(cur.zIndexUpdated=e,Object(r.setStyle)(Object(r.ge)("photo_edit_row"+e),{zIndex:150})),a.hideMove()),extend(cur,{movelnk:i,moveph:e,movehash:t}),cur.privacyPhotoMove||(i.parentNode.replaceChild(c,i),cur.movedd.focus(),cur.movedd.showDefaultList(),addEvent(document,"click",a.hideMove))},hideMove(){if(cur.noZIndexUpdate)delete cur.noZIndexUpdate;else if(!cur.privacyPhotoMove){if(cur.movelnk)try{cur.moveddc.parentNode.replaceChild(cur.movelnk,cur.moveddc),cur.movelnk=!1,cur.movedd.clear(),cur.zIndexUpdated&&Object(r.ge)("photo_edit_row"+cur.zIndexUpdated)&&(Object(r.setStyle)(Object(r.ge)("photo_edit_row"+cur.zIndexUpdated),{zIndex:100}),delete cur.zIndexUpdated)}catch(e){}removeEvent(document,"click",a.hideMove)}},movePhoto(e,t,o){e=intval(e);var c=r.show.pbind("photo_return_progress"+t),i=r.hide.pbind("photo_return_progress"+t);if(!t){if(!e||e==cur.album.split("_")[1])return a.hideMove();t=cur.moveph,o=cur.movehash,c=function(){Object(r.hide)("photo_delete_link"+t),Object(r.show)("photo_edit_progress"+t)},i=function(){Object(r.hide)("photo_edit_progress"+t),Object(r.show)("photo_delete_link"+t)}}ajax.post("al_photos.php",{act:"move_photo",album:e,photo:t,hash:o},{onDone:function(o){var c=Object(r.ge)("photo_edit_row"+t);if(c&&c.firstChild){if(e==cur.album.split("_")[1]){if(Object(r.isVisible)(c.firstChild))return;c.removeChild(c.firstChild.nextSibling),Object(r.show)(c.firstChild),a.recache(cur.offset,1),++cur.count,cur.count>1&&Object(r.show)("album_thumb_action")}else{if(!Object(r.isVisible)(c.firstChild))return;a.hideMove(),Object(r.hide)(c.firstChild),c.appendChild(Object(r.ce)("div",{innerHTML:o})),a.recache(cur.offset,-1),--cur.count,cur.count<2&&Object(r.hide)("album_thumb_action")}cur.photoAddUpdate&&cur.photoAddUpdate(c),cur.introTooltipHide&&cur.introTooltipHide(!0),Object(r.ge)("photos_go_to_album_cont")&&Object(r.toggle)("photos_go_to_album_cont",!!cur.count)}},onFail:function(e){if(a.hideMove(),e)return setTimeout(showFastBox({title:getLang("global_error"),dark:1,bodyStyle:"padding: 20px;"},e).hide,2e3),!0},showProgress:c,hideProgress:i})},updateThumbs(e,t){var o=Object(r.ge)("photos_add_img"+cur.peEditPhoto);o&&(o.src=e)},editPhoto(e,t,o){cur.peEditPhoto=e,showBox("al_photos.php",{act:"edit_photo",photo:e,webgl:1,stat:["ui_controls.css","ui_controls.js"]},{dark:1})},backupDesc(e){cur.descs||(cur.descs={}),cur.descs[e]=trim(Object(r.ge)("photo_caption"+e).value)},saveDesc(e,t){var o=Object(r.ge)("photo_caption"+e).value,a=cur.descs[e];delete cur.descs[e],trim(o)!=a&&ajax.post("al_photos.php",{act:"save_desc",photo:e,hash:t,text:o,edit:1},{onDone:function(t){Object(r.ge)("photo_save_result"+e).innerHTML=t},onFail:function(t){return Object(r.ge)("photo_save_result"+e).innerHTML='<div class="photo_save_error">'+t+"</div>",!0},showProgress:function(){Object(r.ge)("photo_save_result"+e).innerHTML=getLang("photos_privacy_description"),Object(r.show)("photo_save_progress"+e)},hideProgress:function(){Object(r.hide)("photo_save_progress"+e)}})},genFile:(e,t,o)=>Object(r.ce)("div",{innerHTML:`\n        <a class="photo_file_cancel" id="photo_cancel${e}" onclick="${t}">${o}</a>\n        <div class="photo_file_button">\n          <div class="file_button_gray">\n            <div class="file_button" id="photo_file_button${e}">${getLang("photos_choose_file")}</div>\n          </div>\n        </div>\n      `}),initFile(e){FileButton.init("photo_file_button"+e,{name:"photo",id:"photo_file"+e,accept:"image/jpeg,image/png,image/gif",onchange:a.fileSelected})},addFile(){var e=cur.files.length,t=a.genFile(e,"photos.fileCancel("+e+")",getLang("global_cancel"));extend(t,{className:"photo_upload_file",id:"photo_upload_row"+e}),Object(r.ge)("photo_upload_files").appendChild(t),a.initFile(e),cur.files.push({})},filesLoad(){for(var e=0,t=0;e<cur.files.length;++e){if(Object(r.ge)("photo_file"+e).value)break}if(e!=cur.files.length){cur.allcont=utilsNode.appendChild(Object(r.ce)("div",{innerHTML:`\n        <iframe name="photo_frame_all"></iframe>\n        <form target="photo_frame_all" id="photo_form_all" method="POST" action="${cur.url}" enctype="multipart/form-data"></form>\n      `}));var o=Object(r.ge)("photo_form_all"),a=extend(cur.fields,{act:"do_add",al:1,from_host:locHost,ondone:"photos.filesDone",onfail:"photos.filesFail"});for(t in a)a.hasOwnProperty(t)&&o.appendChild(Object(r.ce)("input",{name:t,value:a[t]}));for(e=0,t=0;e<cur.files.length;++e){var c=Object(r.ge)("photo_file"+e);c.value&&(c.name="file"+t,o.appendChild(c),++t)}o.submit()}},fileSelected(){var e=intval(this.id.replace("photo_file",""));if(cur.files[e].deleting||!cur.files[e].cont&&!cur.files[e].id){cur["fileDone"+e]=a.fileDone.pbind(e),cur["fileFail"+e]=a.fileFail.pbind(e),cur.files[e].cont=utilsNode.appendChild(Object(r.ce)("div",{innerHTML:`\n        <iframe name="photo_frame${e}"></iframe>\n        <form target="photo_frame${e}" id="photo_form${e}" method="POST" action="${cur.url}" enctype="multipart/form-data"></form>\n      `}));var t=Object(r.ge)("photo_form"+e),o=extend(cur.fields,{act:"do_add",al:1,from_host:locHost,ondone:"cur.fileDone"+e,onfail:"cur.fileFail"+e});for(var c in o)o.hasOwnProperty(c)&&t.appendChild(Object(r.ce)("input",{name:c,value:o[c]}));t.appendChild(this),t.submit();var i=Object(r.ge)("photo_file_button"+e);lockButton(i),setTimeout(function(){i.innerHTML=i.innerHTML},0),Object(r.show)("photo_cancel"+e),Object(r.ge)("photo_cancel"+e).innerHTML=getLang("global_cancel"),e==cur.files.length-1&&a.addFile()}},fileDone(e,t){Object(r.hide)("photo_cancel"+e);for(var o="",c=e+1;c<cur.files.length;++c)if(cur.files[c].id&&!cur.files[c].deleting){o=cur.files[c].id;break}setTimeout(ajax.post.pbind("al_photos.php",extend({act:"done_add",before:o,context:1},AjaxConvert.fromQueryString(t)),{onDone:function(t,o){if(!t)return a.fileFail(e,0);cur.files[e].cont.innerHTML="",utilsNode.removeChild(cur.files[e].cont),extend(cur.files[e],{id:t,deleting:!1,cont:!1}),Object(r.ge)("photo_upload_row"+e).innerHTML=o,autosizeSetup("photo_caption"+t,{minHeight:30}),Object(r.show)("photo_delete"+t)},onFail:function(t){if(t)return setTimeout(showFastBox({title:getLang("global_error"),dark:1,bodyStyle:"padding: 20px;"},t).hide,3e3),a.fileCancel(e),!0}}),0)},fileCancel(e,t){if(cur.files[e].cont&&(cur.files[e].cont.innerHTML="",utilsNode.removeChild(cur.files[e].cont)),!t){var o=Object(r.ge)("photo_file_button"+e);unlockButton(o),o.innerHTML=getLang("photos_choose_file"),cur.files[e]={},a.initFile(e),Object(r.hide)("photo_cancel"+e)}},fileFail(e,t){a.fileCancel(e)},fileDelete(e,t){for(var o=0;o<cur.files.length&&cur.files[o].id!=e;)++o;if(o!=cur.files.length&&!cur.files[o].deleting){cur.files[o].deleting=!0,ajax.post("al_photos.php",{act:"delete_photo",photo:e,hash:t,edit:2},{onFail:function(){cur.files[o].deleting=!1}});var c=Object(r.ge)("photo_edit_row"+e);c.parentNode.insertBefore(a.genFile(o,"photos.fileRestore('"+e+"', '"+t+"')",getLang("global_restore")),c),Object(r.hide)(c),a.initFile(o),Object(r.show)("photo_cancel"+o)}},fileRestore(e,t){for(var o=0,c="";o<cur.files.length&&cur.files[o].id!=e;)++o;if(o!=cur.files.length&&cur.files[o].deleting&&-1!==cur.files[o].deleting){if(cur.files[o].cont)return a.fileCancel(o);for(var i=o+1;i<cur.files.length;++i)if(cur.files[i].id&&!cur.files[i].deleting){c=cur.files[i].id;break}cur.files[o].deleting=-1,ajax.post("al_photos.php",{act:"restore_photo",photo:e,hash:t,before:c,edit:2},{onDone:function(){cur.files[o].deleting=!1}});var s=Object(r.ge)("photo_edit_row"+e);Object(r.show)(s),Object(r.re)(s.previousSibling)}},filesDone(e){setTimeout(ajax.post.pbind("al_photos.php",extend({act:"done_add",context:2},AjaxConvert.fromQueryString(e))),0)},filesFail(){for(var e=0;e<cur.files.length;++e)a.fileCancel(e);cur.allcont.innerHTML="",utilsNode.removeChild(cur.allcont),cur.allcont=!1},chooseFlash(){if(browser.flash<10)return animate(Object(r.ge)("photo_flash_needed"),{backgroundColor:"#FFEFE8",borderBottomColor:"#E89B88",borderLeftColor:"#E89B88",borderRightColor:"#E89B88",borderTopColor:"#E89B88"},100,()=>{animate(Object(r.ge)("photo_flash_needed"),{backgroundColor:"#FFFFFF",borderBottomColor:"#CCCCCC",borderLeftColor:"#CCCCCC",borderRightColor:"#CCCCCC",borderTopColor:"#CCCCCC"},500)});cur.photoCheckFails=0,Object(r.show)("photo_flash_upload"),Object(r.hide)("photo_default_upload"),Object(r.hide)("photo_upload_unavailable")},chooseDefault(){cur.photoCheckFails=0,Object(r.show)("photo_default_upload"),Object(r.hide)("photo_flash_upload"),cur.serverChecked?(Object(r.show)("photo_upload_files"),Object(r.hide)("photo_default_check")):(Object(r.hide)("photo_upload_files"),Object(r.show)("photo_default_check"),cur.checkUpload())},flashWidth:()=>-1==_ua.indexOf("Mac")||-1==_ua.indexOf("Opera")&&-1==_ua.indexOf("Firefox")?"600":"601",activeTab(e){for(var t=Object(r.domPN)(Object(r.domPN)(e)),o=Object(r.domFC)(t);o;o=Object(r.domNS)(o))Object(r.removeClass)(o,"active_link");Object(r.addClass)(Object(r.domPN)(e),"active_link")},checkHtml5Uploader(){var e=window.XMLHttpRequest||window.XDomainRequest,t=window.MozBlobBuilder||window.WebKitBlobBuilder||window.BlobBuilder;return e&&(window.FormData||window.FileReader&&(window.XMLHttpRequest&&XMLHttpRequest.sendAsBinary||window.ArrayBuffer&&window.Uint8Array&&t))},upload:(e,t)=>t&&(2==t.button||t.ctrlKey)?(a.checkHtml5Uploader()&&(e.href+="&html5=1"),!0):!(void 0!==cur.uplId&&window.Upload&&Upload.checked&&Upload.checked[cur.uplId]&&a.checkHtml5Uploader())||(Object(r.ge)("photos_upload_input").click(),!1),uploadLink:(e,t)=>(a.checkHtml5Uploader()&&(e.href+="&html5=1"),nav.go(e,t)),onUploadSelect(e){if(Object(r.ge)("photos_upload_area")){window.filesToUpload=e;var t=Object(r.ge)("photos_upload_area").innerHTML;Object(r.ge)("photos_upload_area").innerHTML='<img src="/images/upload.gif">',nav.go(Object(r.ge)("photos_upload_area").href+"&html5=1",!1,{onFail:function(e){return Object(r.ge)("photos_upload_area").innerHTML=t,setTimeout(showFastBox({title:getLang("global_error"),dark:1,bodyStyle:"padding: 20px;"},e).hide,3e3),!0}})}},thumbOver(e,t,o){cur.hideTO&&cur.hideTO[t]&&clearTimeout(cur.hideTO[t]);var a=Object(r.geByClass1)("description",e),c=Object(r.geByClass1)("photo_album_title",e),i=Object(r.getSize)(a)[1];animate(c,{marginTop:163-(i?i+7:0)},{duration:200,transition:Fx.Transitions.easeOutCirc});var s=Object(r.geByClass1)("photo_album_info_back",e),l=Object(r.geByClass1)("photo_album_info_cont",e);if(s&&l)if(!s.over||o){var d=o?.6:.5,n=o?1:.8;o&&(s.over=1),animate(s,{opacity:d},{duration:200,transition:Fx.Transitions.easeOutCirc}),animate(l,{opacity:n},{duration:200,transition:Fx.Transitions.easeOutCirc})}else s.over=0},thumbOut(e,t,o){var a=Object(r.geByClass1)("photo_album_info_back",e),c=Object(r.geByClass1)("photo_album_info_cont",e),i=()=>{if(o){var t=Object(r.geByClass1)("photo_album_title",e);animate(t,{marginTop:163},200)}if(a&&c){var i=o?0:.8;animate(a,{opacity:o?0:.5},200),animate(c,{opacity:i},200)}};o?(cur.hideTO=cur.hideTO||{},cur.hideTO[t]=setTimeout(i,150)):i()},openEditor:(e,t)=>(stManager.add([jsc("web/photoview.js"),"photoview.css"],function(){var t=Object(r.gpeByClass)("photos_photo_edit_row",e);cur.onPESave=function(e){curBox().hide(),Object(r.setStyle)(Object(r.geByClass1)("photos_photo_edit_row_thumb",t),"background-image","url('"+e+"')"),cur.onPESave=!1,bodyNode.style.overflow="auto"};var o=t.getAttribute("data-id");Photoview.openEditor(o,cur.savedThumbs?cur.savedThumbs[o]:t.getAttribute("data-thumb"))}),cancelEvent(t)),addToAlbum(){cur.isPhotoUpload=!0,a.movePhotosBox(cur.savedPhotos||[],!1)},movePhotosBox(e,t,o,c){var i=[],s=!1;isArray(e)?i=e:(""===e&&t&&(e=Object(r.gpeByClass)("photos_photo_edit_row",t).getAttribute("data-id")),e?i.push(e):each(Object(r.geByClass)("photos_edit_selected"),function(){i.push(this.getAttribute("data-id"))}),s=intval(a._editGetSelectedCount()>i.length));var l=cur.album?cur.album.split("_"):[vk.id];return showBox("/al_photos.php",{act:"a_move_to_album_box",photo_ids:s?"":i.join(","),owner_id:l[0],from_album_id:l[1],all:s},{onDone:o}),cancelEvent(c)},cancelMove(e,t,o,c,i,s,l){var d=Object(r.gpeByClass)("photos_photo_edit_row",t);Object(r.re)(Object(r.geByClass1)("photos_cancel_move",d)),a._showProgressPanel(d),ajax.post("al_photos.php",{act:"move_photos",photos:o,to_album_id:c,from_album_id:i,hash:l,owner_id:s},{onDone:function(){a._hideProgressPanel(d),cur.count++,a._editUpdateSelectedCounter()}}),cancelEvent(e)},doMovePhotos(e,t,o){var c=Object(r.domClosest)("_photos_album",t),i=Object(r.domData)(c,"aid"),s=Object(r.domData)(c,"from-aid"),l=Object(r.domData)(c,"owner-id"),d=Object(r.domData)(c,"move-hash"),n=Object(r.domData)(c,"from"),u=Object(r.geByClass1)("photos_album_counter",t),h=Object(r.geByClass1)("photos_album_thumb",t),p=Object(r.ge)("pv_move_to_album_progress");h.insertBefore(p,h.children[0]),Object(r.show)(p),Object(r.addClass)(t,"photos_in_progress"),Object(r.addClass)(Object(r.gpeByClass)("photos_container_albums",t),"photos_inactive"),a.doEditBatchProcess({act:"move_photos",to_album_id:i,from_album_id:s,owner_id:l,hash:d,from:n},cur.editPhotosArray,Object(r.ge)("pv_move_to_album_progress"),"photos_move_in_progress_title",function(e,t,c,d,n,h){cur.count=Math.max(cur.count-e,0),Object(r.val)(u,+Object(r.val)(u)+e),each(c,function(e,t){var a=Object(r.ge)("photo_edit_row_"+t);if(!cur.isPhotoUpload)if(a&&!o){var c="return photos.cancelMove(event, this, '"+t+"', "+s+", "+i+", "+l+", '"+h+"')",d=Object(r.se)('<div class="photos_cancel_move"><a href="" onclick="'+c+'">'+getLang("global_cancel")+"</a></div>");a.appendChild(d)}else Object(r.re)(a);cur.count=Math.max(cur.count,0)}),a._editUpdateSelectedCounter()},function(e,t){var c=curBox();c&&c.hide();var i=langNumeric(e,cur.lang.photos_x_photos_moved_no_cancel);(i=i.replace("{album}",t),showDoneBox(i),cur.pvShown&&cur.pvCurPhoto&&(cur.pvCurPhoto.album=t,Object(r.geByClass1)("pv_album_name").innerHTML=t),o||cur.isPhotoUpload)&&(0==cur.count?nav.reload():Object(r.geByClass)("photos_photo_edit_row").length<40&&a.load())}),e&&cancelEvent(e)},publishPhotos(e){if(cur.savedPhotos){cur.savingPhotos=!0;var t={act:"post",type:"photos_upload",to_id:vk.id,attach1_type:"photos_list",attach1:(cur.savedPhotos||[]).join(","),hash:cur.post_hash};ajax.post("/al_wall.php",t,{showProgress:lockButton.pbind(e),onDone:function(){delete cur._back,nav.go("/al_profile.php"),showBackLink()}})}return!1},registerDragZone(e){addEvent(document,"dragenter dragover",function(t){if(a.checkHtml5Uploader())return setTimeout(function(){clearTimeout(cur.dragTimer),delete cur.dragTimer},0),e.on(t),cancelEvent(t)}),addEvent(document,"dragleave",function(t){cur.dragTimer&&(clearTimeout(cur.dragTimer),delete cur.dragTimer),cur.dragTimer=setTimeout(function(){e.un(t)},100),cancelEvent(t)}),addEvent(document,"drop",function(t){return e.un(t,!0),e.drop(t.dataTransfer.files),cancelEvent(t)}),cur.destroy.push(function(){removeEvent(document,"dragenter dragover"),removeEvent(document,"dragleave"),removeEvent(document,"drop")})},openWebcamPhoto(){showBox("al_photos.php",{act:"webcam_photo",oid:cur.oid},{params:{dark:1}}).setOptions({width:644})},initWebcam(e,t){cur.lang=extend(cur.lang||{},t),e.setOptions({hideButtons:!0,width:644,bodyStyle:"padding:0px;border:0px;"}),a.cameraInit()},cameraInit(){var e=["ajx=1"];for(var t in Upload.vars[cur.uplId])Upload.vars[cur.uplId].hasOwnProperty(t)&&e.push(t+"="+Upload.vars[cur.uplId][t]);var o=Upload.uploadUrls[cur.uplId]+(Upload.uploadUrls[cur.uplId].match(/\?/)?"&":"?")+e.join("&"),a={s_noCamera:getLang("profile_no_camera"),s_noAccess:getLang("profile_no_camera_access"),s_setAccess:getLang("profile_set_camera_access"),s_capture:getLang("profile_capture_image"),s_videoMode:getLang("profile_to_video_mode"),upload_url:o,saveClbk:"photos.cameraPhotoDone",hideClbk:"photos.uploadReturn",overClbk:"photos.cameraBtnOver",outClbk:"photos.cameraBtnOut",downClbk:"photos.cameraBtnDown",upClbk:"photos.cameraBtnUp",showSaveClbk:"photos.showCameraSaveBtn",hideSaveClbk:"photos.hideCameraSaveBtn",hideCaptureClbk:"photos.hideCameraCaptureBtn",progressClbk:"photos.cameraSaveProgress",getBtnsPos:"photos.updateCameraButtonsPos",jpgQuality:"95"};for(var c in a)a.hasOwnProperty(c)&&(a[c]=winToUtf(a[c]));return e={allownetworking:"true",wmode:"transparent"},this.addWebcamPhotoControls=Object(r.geByClass1)("add_webcam_photo_controls"),Object(r.hide)("camera_button_no"),renderFlash("webcam_photo",{url:"/swf/CaptureImg.swf",id:"flash_camera",width:604,height:480,preventhide:1,style:"visibility: visible",version:9},e,a),!1},cameraPhotoDone(e){delete this.addWebcamPhotoControls,e=JSON.parse(e.replace(/\\"/g,'"')),ajax.post("al_photos.php",extend({act:"choose_uploaded"},e),{onDone:function(e,t){a.showEditView(e,t)}})},updateCameraButtonsPos(){var e=this.addWebcamPhotoControls,t=[],o=Object(r.getXY)(e);Object(r.setStyle)(this.addWebcamPhotoControls,{visibility:"visible"});var a=function(e,a){if(Object(r.isVisible)(a.parentNode)){var c=Object(r.getXY)(a),i=Object(r.getSize)(a);t.push([c[0]-o[0],c[1]-o[1],i[0]+2,i[1]+2])}};each(Object(r.geByTag)("button",e),a),each(Object(r.geByClass)("button",e),a),1==t.length&&t.push([999,999,1,1]),Object(r.ge)("flash_camera").setButtonsPos&&Object(r.ge)("flash_camera").setButtonsPos(t)},showCameraSaveBtn(){Object(r.show)("camera_button_no"),Object(r.ge)("camera_button_yes").innerHTML=getLang("profile_oph_camera_save"),Object(r.ge)("camera_button_no").innerHTML=getLang("profile_to_video_mode"),this.updateCameraButtonsPos()},hideCameraSaveBtn(e){Object(r.hide)("camera_button_no");var t=Object(r.ge)("camera_button_no");Object(r.ge)("camera_button_yes").innerHTML=getLang("profile_capture_image"),t&&(t.innerHTML=getLang("profile_oph_camera_back")),e||this.updateCameraButtonsPos()},hideCameraCaptureBtn(){Object(r.hide)(Object(r.ge)("camera_button_no").parentNode),Object(r.ge)("camera_button_yes").innerHTML=getLang("profile_no_camera_back"),this.updateCameraButtonsPos()},cameraSaveProgress(e){var t=Object(r.ge)("camera_button_yes");t&&(e?lockButton(t):unlockButton(t))},cameraBtnOver(e){var t=Object(r.geByClass1)(e,this.addWebcamPhotoControls);t&&Object(r.addClass)(t,"hover")},cameraBtnOut(e){var t=Object(r.geByClass1)(e,this.addWebcamPhotoControls);t&&(Object(r.removeClass)(t,"hover"),Object(r.removeClass)(t,"active"))},cameraBtnDown(e){var t=Object(r.geByClass1)(e,this.addWebcamPhotoControls);t&&Object(r.addClass)(t,"active")},cameraBtnUp(e){var t=Object(r.geByClass1)(e,this.addWebcamPhotoControls);t&&Object(r.removeClass)(t,"active")},uploadReturn(){curBox().hide(),delete this.addWebcamPhotoControls},showEditView(e,t){cur.webcamPhotoMedia=e,cur.pvPhoto=null,cur.uploadPhotoData=t,stManager.add([jsc("web/photoview.js")],function(){cur.fromWebcam=!0,Photoview.openEditor(e,t.editable.sizes.x[0])})},onFiltersSave(){cur.imMedia?cur.imMedia.chooseMedia("photo",cur.webcamPhotoMedia,extend(cur.uploadPhotoData,{upload_ind:cur.imUploadInd+"_selfie"})):cur.chooseMedia("photo",cur.webcamPhotoMedia,extend(cur.uploadPhotoData,{upload_ind:cur.uplId+"_selfie"})),delete cur.webcamPhotoMedia,delete cur.uploadPhotoData},returnToWebcam(){curBox().hide(),this.openWebcamPhoto()}}},YQuP:function(e,t,o){"use strict";o.r(t);var r=o("1OKH");window.photos=r.photos;try{stManager.done(jsc("web/photos.js"))}catch(e){}}});